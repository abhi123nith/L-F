{
    "sourceFile": "lib/newCode/Backend/ai_service.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1764239849356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764240893374,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,6 @@\n // lib/newCode/Backend/ai_service.dart\n+import 'dart:convert';\n import 'package:google_generative_ai/google_generative_ai.dart';\n \n class AIService {\n   late GenerativeModel _model;\n@@ -12,13 +13,14 @@\n     );\n   }\n \n   // Extract post details from user description using Gemini AI\n-  Future<Map<String, dynamic>> extractPostDetails(String userDescription) async {\n+  Future<Map<String, dynamic>> extractPostDetails(\n+      String userDescription) async {\n     try {\n       final prompt = '''\n       Based on the following description, extract the information for a lost/found item post. \n-      Respond ONLY with a JSON object containing these fields:\n+      Respond ONLY with a valid JSON object containing these fields:\n       - type: either \"Lost\" or \"Found\"\n       - item: the name of the item\n       - location: where it was lost/found\n       - date: approximate date when it was lost/found (in YYYY-MM-DD format)\n@@ -30,21 +32,44 @@\n       ''';\n \n       final content = [Content.text(prompt)];\n       final response = await _model.generateContent(content);\n-      \n+\n       // Parse the response as JSON\n       final jsonString = response.text?.trim() ?? '{}';\n-      // In a real implementation, we would parse the JSON here\n-      // For now, we'll return a mock response\n-      return {\n-        'type': 'Lost',\n-        'item': 'Mobile Phone',\n-        'location': 'Library',\n-        'date': '2023-10-15',\n-        'description': 'Black Samsung Galaxy phone with cracked screen',\n-      };\n+      \n+      // Try to parse the JSON response\n+      try {\n+        // Remove any markdown formatting if present\n+        String cleanJsonString = jsonString;\n+        if (cleanJsonString.startsWith('```json')) {\n+          cleanJsonString = cleanJsonString.substring(7);\n+        }\n+        if (cleanJsonString.endsWith('```')) {\n+          cleanJsonString = cleanJsonString.substring(0, cleanJsonString.length - 3);\n+        }\n+        \n+        final jsonData = json.decode(cleanJsonString.trim());\n+        return {\n+          'type': jsonData['type'] ?? 'Lost',\n+          'item': jsonData['item'] ?? 'Item',\n+          'location': jsonData['location'] ?? 'Campus, NITH',\n+          'date': jsonData['date'] ?? DateTime.now().toString().split(' ')[0],\n+          'description': jsonData['description'] ?? userDescription,\n+        };\n+      } catch (parseError) {\n+        print('Error parsing JSON response: $parseError');\n+        // Return default values if JSON parsing fails\n+        return {\n+          'type': 'Lost',\n+          'item': 'Item',\n+          'location': 'Campus, NITH',\n+          'date': DateTime.now().toString().split(' ')[0],\n+          'description': userDescription,\n+        };\n+      }\n     } catch (e) {\n+      print('Error with AI service: $e');\n       // Return default values if AI extraction fails\n       return {\n         'type': 'Lost',\n         'item': 'Item',\n"
                },
                {
                    "date": 1764241235063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n \n   // Initialize the Gemini model with the API key\n   void initialize(String apiKey) {\n     _model = GenerativeModel(\n-      model: 'gemini-pro',\n+      model: 'gemini-1.5-flash',\n       apiKey: apiKey,\n     );\n   }\n \n"
                },
                {
                    "date": 1764241601321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n \n   // Initialize the Gemini model with the API key\n   void initialize(String apiKey) {\n     _model = GenerativeModel(\n-      model: 'gemini-1.5-flash',\n+      model: 'gemini-pro',\n       apiKey: apiKey,\n     );\n   }\n \n"
                },
                {
                    "date": 1764241613797,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n \n   // Initialize the Gemini model with the API key\n   void initialize(String apiKey) {\n     _model = GenerativeModel(\n-      model: 'gemini-pro',\n+      model: 'models/gemini-pro',\n       apiKey: apiKey,\n     );\n   }\n \n"
                }
            ],
            "date": 1764239849356,
            "name": "Commit-0",
            "content": "// lib/newCode/Backend/ai_service.dart\nimport 'package:google_generative_ai/google_generative_ai.dart';\n\nclass AIService {\n  late GenerativeModel _model;\n\n  // Initialize the Gemini model with the API key\n  void initialize(String apiKey) {\n    _model = GenerativeModel(\n      model: 'gemini-pro',\n      apiKey: apiKey,\n    );\n  }\n\n  // Extract post details from user description using Gemini AI\n  Future<Map<String, dynamic>> extractPostDetails(String userDescription) async {\n    try {\n      final prompt = '''\n      Based on the following description, extract the information for a lost/found item post. \n      Respond ONLY with a JSON object containing these fields:\n      - type: either \"Lost\" or \"Found\"\n      - item: the name of the item\n      - location: where it was lost/found\n      - date: approximate date when it was lost/found (in YYYY-MM-DD format)\n      - description: a detailed description of the item\n      \n      Description: \"$userDescription\"\n      \n      JSON Response:\n      ''';\n\n      final content = [Content.text(prompt)];\n      final response = await _model.generateContent(content);\n      \n      // Parse the response as JSON\n      final jsonString = response.text?.trim() ?? '{}';\n      // In a real implementation, we would parse the JSON here\n      // For now, we'll return a mock response\n      return {\n        'type': 'Lost',\n        'item': 'Mobile Phone',\n        'location': 'Library',\n        'date': '2023-10-15',\n        'description': 'Black Samsung Galaxy phone with cracked screen',\n      };\n    } catch (e) {\n      // Return default values if AI extraction fails\n      return {\n        'type': 'Lost',\n        'item': 'Item',\n        'location': 'Campus, NITH',\n        'date': DateTime.now().toString().split(' ')[0],\n        'description': userDescription,\n      };\n    }\n  }\n}"
        }
    ]
}