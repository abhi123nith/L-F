{
    "sourceFile": "lib/newCode/Frontend/pages/create_post/ai_create_post_page.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1764239884710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764239971524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,19 +1,20 @@\n // lib/newCode/Frontend/pages/create_post/ai_create_post_page.dart\n import 'dart:typed_data';\n+\n import 'package:cloud_firestore/cloud_firestore.dart';\n import 'package:firebase_auth/firebase_auth.dart';\n import 'package:firebase_storage/firebase_storage.dart';\n import 'package:flutter/foundation.dart';\n import 'package:flutter/material.dart';\n import 'package:image_picker/image_picker.dart';\n import 'package:l_f/newCode/Backend/ai_service.dart';\n-import 'package:l_f/newCode/Backend/firestore_service.dart';\n-import 'package:l_f/newCode/constants/lists.dart';\n+import 'package:l_f/Backend/firestore_service.dart';\n+import 'package:l_f/Frontend/Contants/lists.dart';\n \n class AICreatePostPage extends StatefulWidget {\n   final String geminiApiKey;\n-  \n+\n   const AICreatePostPage({super.key, required this.geminiApiKey});\n \n   @override\n   _AICreatePostPageState createState() => _AICreatePostPageState();\n@@ -22,13 +23,13 @@\n class _AICreatePostPageState extends State<AICreatePostPage> {\n   final _formKey = GlobalKey<FormState>();\n   final FirestoreService _firestoreService = FirestoreService();\n   final AIService _aiService = AIService();\n-  \n+\n   List<Uint8List>? _imageBytes;\n   bool _isLoading = false;\n   bool _isProcessingAI = false;\n-  \n+\n   // Post fields\n   String _status = 'Lost';\n   String? _title;\n   String? _location;\n@@ -86,18 +87,19 @@\n     });\n \n     try {\n       final extractedData = await _aiService.extractPostDetails(_description!);\n-      \n+\n       setState(() {\n         _status = extractedData['type'] ?? 'Lost';\n         _title = extractedData['item'] ?? 'Item';\n         _location = extractedData['location'] ?? 'Campus, NITH';\n         // We won't use the date from AI as our app doesn't have a date field\n-        \n+\n         // If the location is a hostel, set the hostel field\n         if (_location == 'Boys Hostel' || _location == 'Girls Hostel') {\n-          _hostel = 'Some Hostel'; // This would need to be more specific in a real implementation\n+          _hostel =\n+              'Some Hostel'; // This would need to be more specific in a real implementation\n         }\n       });\n \n       ScaffoldMessenger.of(context).showSnackBar(\n@@ -109,9 +111,10 @@\n     } catch (e) {\n       print('Error processing with AI: $e');\n       ScaffoldMessenger.of(context).showSnackBar(\n         const SnackBar(\n-          content: Text('Error processing with AI. Please fill details manually.'),\n+          content:\n+              Text('Error processing with AI. Please fill details manually.'),\n           backgroundColor: Colors.red,\n         ),\n       );\n     } finally {\n@@ -203,34 +206,38 @@\n                       TextFormField(\n                         decoration: const InputDecoration(\n                           labelText: 'Describe your lost/found item',\n                           border: OutlineInputBorder(),\n-                          helperText: 'Example: I lost my black iPhone near the library yesterday',\n+                          helperText:\n+                              'Example: I lost my black iPhone near the library yesterday',\n                         ),\n                         maxLines: 3,\n                         onChanged: (value) => _description = value,\n-                        validator: (value) => value!.isEmpty\n-                            ? 'Please describe your item'\n-                            : null,\n+                        validator: (value) =>\n+                            value!.isEmpty ? 'Please describe your item' : null,\n                       ),\n                       const SizedBox(height: 16),\n-                      \n+\n                       // AI Process Button\n                       Center(\n                         child: ElevatedButton.icon(\n                           onPressed: _isProcessingAI ? null : _processWithAI,\n-                          icon: _isProcessingAI \n+                          icon: _isProcessingAI\n                               ? const SizedBox(\n                                   width: 16,\n                                   height: 16,\n                                   child: CircularProgressIndicator(\n                                     strokeWidth: 2,\n-                                    valueColor: AlwaysStoppedAnimation<Color>(Colors.white),\n+                                    valueColor: AlwaysStoppedAnimation<Color>(\n+                                        Colors.white),\n                                   ),\n                                 )\n-                              : const Icon(Icons.auto_fix_high, color: Colors.white),\n+                              : const Icon(Icons.auto_fix_high,\n+                                  color: Colors.white),\n                           label: Text(\n-                            _isProcessingAI ? 'Processing...' : 'Extract Details with AI',\n+                            _isProcessingAI\n+                                ? 'Processing...'\n+                                : 'Extract Details with AI',\n                             style: const TextStyle(color: Colors.white),\n                           ),\n                           style: ElevatedButton.styleFrom(\n                             backgroundColor: Colors.deepPurple,\n@@ -240,9 +247,9 @@\n                       const SizedBox(height: 16),\n \n                       const Divider(),\n                       const SizedBox(height: 16),\n-                      \n+\n                       // Manual form fields (will be populated by AI)\n                       Row(\n                         mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n                         children: [\n@@ -310,18 +317,20 @@\n                             .toList(),\n                         onChanged: (value) {\n                           setState(() {\n                             _location = value;\n-                            _hostel = null; // Reset hostel selection when location changes\n+                            _hostel =\n+                                null; // Reset hostel selection when location changes\n                           });\n                         },\n                         validator: (value) =>\n                             value == null ? 'Please select a location' : null,\n                       ),\n                       const SizedBox(height: 16),\n \n                       // Hostel dropdown (conditional)\n-                      if (_location == 'Boys Hostel' || _location == 'Girls Hostel')\n+                      if (_location == 'Boys Hostel' ||\n+                          _location == 'Girls Hostel')\n                         DropdownButtonFormField<String>(\n                           decoration: const InputDecoration(\n                             labelText: 'Hostel Name',\n                             border: OutlineInputBorder(),\n@@ -369,9 +378,10 @@\n                       // Question field (only for 'Found' items)\n                       if (_status == 'Found')\n                         TextFormField(\n                           decoration: const InputDecoration(\n-                            labelText: 'Verification Question (to ask the Claimer)',\n+                            labelText:\n+                                'Verification Question (to ask the Claimer)',\n                             border: OutlineInputBorder(),\n                           ),\n                           onSaved: (value) => _question = value,\n                           validator: (value) {\n@@ -389,9 +399,10 @@\n                         width: 200,\n                         child: Center(\n                           child: ElevatedButton.icon(\n                             onPressed: _pickImages,\n-                            icon: const Icon(Icons.photo_library, color: Colors.white),\n+                            icon: const Icon(Icons.photo_library,\n+                                color: Colors.white),\n                             label: const Text(\n                               'Select Images',\n                               style: TextStyle(color: Colors.white),\n                             ),\n@@ -411,9 +422,10 @@\n                             scrollDirection: Axis.horizontal,\n                             itemCount: _imageBytes!.length,\n                             itemBuilder: (context, index) {\n                               return Padding(\n-                                padding: const EdgeInsets.symmetric(horizontal: 8.0),\n+                                padding:\n+                                    const EdgeInsets.symmetric(horizontal: 8.0),\n                                 child: Stack(\n                                   children: [\n                                     ClipRRect(\n                                       borderRadius: BorderRadius.circular(12),\n@@ -427,9 +439,10 @@\n                                     Positioned(\n                                       top: 0,\n                                       right: 0,\n                                       child: IconButton(\n-                                        icon: const Icon(Icons.cancel, color: Colors.red),\n+                                        icon: const Icon(Icons.cancel,\n+                                            color: Colors.red),\n                                         onPressed: () => _removeImage(index),\n                                       ),\n                                     ),\n                                   ],\n@@ -464,5 +477,5 @@\n         ),\n       ),\n     );\n   }\n-}\n\\ No newline at end of file\n+}\n"
                },
                {
                    "date": 1764239992284,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,16 +1,13 @@\n // lib/newCode/Frontend/pages/create_post/ai_create_post_page.dart\n import 'dart:typed_data';\n \n-import 'package:cloud_firestore/cloud_firestore.dart';\n-import 'package:firebase_auth/firebase_auth.dart';\n-import 'package:firebase_storage/firebase_storage.dart';\n import 'package:flutter/foundation.dart';\n import 'package:flutter/material.dart';\n import 'package:image_picker/image_picker.dart';\n-import 'package:l_f/newCode/Backend/ai_service.dart';\n import 'package:l_f/Backend/firestore_service.dart';\n import 'package:l_f/Frontend/Contants/lists.dart';\n+import 'package:l_f/newCode/Backend/ai_service.dart';\n \n class AICreatePostPage extends StatefulWidget {\n   final String geminiApiKey;\n \n@@ -21,9 +18,9 @@\n }\n \n class _AICreatePostPageState extends State<AICreatePostPage> {\n   final _formKey = GlobalKey<FormState>();\n-  final FirestoreService _firestoreService = FirestoreService();\n+  late final FirestoreService _firestoreService;\n   final AIService _aiService = AIService();\n \n   List<Uint8List>? _imageBytes;\n   bool _isLoading = false;\n"
                },
                {
                    "date": 1764240012238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n import 'package:flutter/foundation.dart';\n import 'package:flutter/material.dart';\n import 'package:image_picker/image_picker.dart';\n import 'package:l_f/Backend/firestore_service.dart';\n-import 'package:l_f/Frontend/Contants/lists.dart';\n+import 'package:l_f/Frontend/Contants/lists.dart' show itemsList, locationsList, boyshostelsList, girlshostelsList;\n import 'package:l_f/newCode/Backend/ai_service.dart';\n \n class AICreatePostPage extends StatefulWidget {\n   final String geminiApiKey;\n@@ -37,8 +37,9 @@\n   @override\n   void initState() {\n     super.initState();\n     _aiService.initialize(widget.geminiApiKey);\n+    _firestoreService = FirestoreService();\n     _firestoreService.fetchUserData();\n   }\n \n   Future<void> _pickImages() async {\n"
                },
                {
                    "date": 1764241265201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,10 @@\n import 'package:flutter/foundation.dart';\n import 'package:flutter/material.dart';\n import 'package:image_picker/image_picker.dart';\n import 'package:l_f/Backend/firestore_service.dart';\n-import 'package:l_f/Frontend/Contants/lists.dart' show itemsList, locationsList, boyshostelsList, girlshostelsList;\n+import 'package:l_f/Frontend/Contants/lists.dart'\n+    show itemsList, locationsList, boyshostelsList, girlshostelsList;\n import 'package:l_f/newCode/Backend/ai_service.dart';\n \n class AICreatePostPage extends StatefulWidget {\n   final String geminiApiKey;\n@@ -27,10 +28,10 @@\n   bool _isProcessingAI = false;\n \n   // Post fields\n   String _status = 'Lost';\n-  String? _title;\n-  String? _location;\n+  String _title = 'Mobile Phone';  // Initialize with a default value\n+  String _location = 'Campus, NITH';  // Initialize with a default value\n   String? _description;\n   String? _question;\n   String? _hostel;\n \n"
                },
                {
                    "date": 1764241287042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -293,11 +293,13 @@\n                             .toList(),\n                         validator: (value) =>\n                             value == null ? 'Please select a title' : null,\n                         onChanged: (value) {\n-                          setState(() {\n-                            _title = value;\n-                          });\n+                          if (value != null) {\n+                            setState(() {\n+                              _title = value;\n+                            });\n+                          }\n                         },\n                       ),\n                       const SizedBox(height: 16),\n \n"
                },
                {
                    "date": 1764241294238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -316,13 +316,15 @@\n                                   child: Text(location),\n                                 ))\n                             .toList(),\n                         onChanged: (value) {\n-                          setState(() {\n-                            _location = value;\n-                            _hostel =\n-                                null; // Reset hostel selection when location changes\n-                          });\n+                          if (value != null) {\n+                            setState(() {\n+                              _location = value;\n+                              _hostel =\n+                                  null; // Reset hostel selection when location changes\n+                            });\n+                          }\n                         },\n                         validator: (value) =>\n                             value == null ? 'Please select a location' : null,\n                       ),\n"
                },
                {
                    "date": 1764241314149,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -347,11 +347,13 @@\n                                     child: Text(hostel),\n                                   ))\n                               .toList(),\n                           onChanged: (value) {\n-                            setState(() {\n-                              _hostel = value;\n-                            });\n+                            if (value != null) {\n+                              setState(() {\n+                                _hostel = value;\n+                              });\n+                            }\n                           },\n                           validator: (value) {\n                             if ((_location == 'Boys Hostel' ||\n                                     _location == 'Girls Hostel') &&\n"
                }
            ],
            "date": 1764239884710,
            "name": "Commit-0",
            "content": "// lib/newCode/Frontend/pages/create_post/ai_create_post_page.dart\nimport 'dart:typed_data';\nimport 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:firebase_storage/firebase_storage.dart';\nimport 'package:flutter/foundation.dart';\nimport 'package:flutter/material.dart';\nimport 'package:image_picker/image_picker.dart';\nimport 'package:l_f/newCode/Backend/ai_service.dart';\nimport 'package:l_f/newCode/Backend/firestore_service.dart';\nimport 'package:l_f/newCode/constants/lists.dart';\n\nclass AICreatePostPage extends StatefulWidget {\n  final String geminiApiKey;\n  \n  const AICreatePostPage({super.key, required this.geminiApiKey});\n\n  @override\n  _AICreatePostPageState createState() => _AICreatePostPageState();\n}\n\nclass _AICreatePostPageState extends State<AICreatePostPage> {\n  final _formKey = GlobalKey<FormState>();\n  final FirestoreService _firestoreService = FirestoreService();\n  final AIService _aiService = AIService();\n  \n  List<Uint8List>? _imageBytes;\n  bool _isLoading = false;\n  bool _isProcessingAI = false;\n  \n  // Post fields\n  String _status = 'Lost';\n  String? _title;\n  String? _location;\n  String? _description;\n  String? _question;\n  String? _hostel;\n\n  @override\n  void initState() {\n    super.initState();\n    _aiService.initialize(widget.geminiApiKey);\n    _firestoreService.fetchUserData();\n  }\n\n  Future<void> _pickImages() async {\n    try {\n      final ImagePicker picker = ImagePicker();\n      final List<XFile> pickedFiles = await picker.pickMultiImage();\n\n      if (pickedFiles.isNotEmpty) {\n        List<Uint8List> imageBytes = [];\n        for (var pickedFile in pickedFiles) {\n          final Uint8List fileBytes = await pickedFile.readAsBytes();\n          imageBytes.add(fileBytes);\n        }\n\n        setState(() {\n          _imageBytes = imageBytes;\n        });\n      }\n    } catch (e) {\n      print('Error picking files: $e');\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          content: Text('Error selecting images'),\n          backgroundColor: Colors.red,\n        ),\n      );\n    }\n  }\n\n  Future<void> _processWithAI() async {\n    if (_description == null || _description!.isEmpty) {\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          content: Text('Please enter a description first'),\n          backgroundColor: Colors.orange,\n        ),\n      );\n      return;\n    }\n\n    setState(() {\n      _isProcessingAI = true;\n    });\n\n    try {\n      final extractedData = await _aiService.extractPostDetails(_description!);\n      \n      setState(() {\n        _status = extractedData['type'] ?? 'Lost';\n        _title = extractedData['item'] ?? 'Item';\n        _location = extractedData['location'] ?? 'Campus, NITH';\n        // We won't use the date from AI as our app doesn't have a date field\n        \n        // If the location is a hostel, set the hostel field\n        if (_location == 'Boys Hostel' || _location == 'Girls Hostel') {\n          _hostel = 'Some Hostel'; // This would need to be more specific in a real implementation\n        }\n      });\n\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          content: Text('Post details extracted successfully!'),\n          backgroundColor: Colors.green,\n        ),\n      );\n    } catch (e) {\n      print('Error processing with AI: $e');\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          content: Text('Error processing with AI. Please fill details manually.'),\n          backgroundColor: Colors.red,\n        ),\n      );\n    } finally {\n      setState(() {\n        _isProcessingAI = false;\n      });\n    }\n  }\n\n  Future<void> _submitData() async {\n    if (_formKey.currentState?.validate() == false) {\n      return;\n    }\n    _formKey.currentState?.save();\n\n    if (_imageBytes == null || _imageBytes!.isEmpty) {\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          backgroundColor: Colors.deepOrange,\n          content: Text('Please select at least one image'),\n        ),\n      );\n      return;\n    }\n\n    setState(() {\n      _isLoading = true;\n    });\n\n    try {\n      await _firestoreService.createPost(\n        status: _status,\n        title: _title!,\n        location: _location!,\n        description: _description!,\n        imageBytes: _imageBytes!,\n        hostel: _hostel,\n        question: _question,\n      );\n\n      ScaffoldMessenger.of(context).showSnackBar(\n        const SnackBar(\n          backgroundColor: Colors.green,\n          content: Text('Item uploaded successfully!'),\n        ),\n      );\n      Navigator.of(context).pop();\n    } catch (e) {\n      ScaffoldMessenger.of(context).showSnackBar(\n        SnackBar(\n          backgroundColor: Colors.red,\n          content: Text('Error uploading item: $e'),\n        ),\n      );\n    } finally {\n      setState(() {\n        _isLoading = false;\n      });\n    }\n  }\n\n  void _removeImage(int index) {\n    setState(() {\n      _imageBytes!.removeAt(index);\n    });\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        backgroundColor: Colors.deepOrange,\n        foregroundColor: Colors.white,\n        title: const Text('AI-Powered Post Creation'),\n      ),\n      body: Center(\n        child: SizedBox(\n          width: 500,\n          child: Card(\n            child: Padding(\n              padding: const EdgeInsets.all(16.0),\n              child: Form(\n                key: _formKey,\n                child: SingleChildScrollView(\n                  child: Column(\n                    crossAxisAlignment: CrossAxisAlignment.start,\n                    children: [\n                      // Description input for AI processing\n                      TextFormField(\n                        decoration: const InputDecoration(\n                          labelText: 'Describe your lost/found item',\n                          border: OutlineInputBorder(),\n                          helperText: 'Example: I lost my black iPhone near the library yesterday',\n                        ),\n                        maxLines: 3,\n                        onChanged: (value) => _description = value,\n                        validator: (value) => value!.isEmpty\n                            ? 'Please describe your item'\n                            : null,\n                      ),\n                      const SizedBox(height: 16),\n                      \n                      // AI Process Button\n                      Center(\n                        child: ElevatedButton.icon(\n                          onPressed: _isProcessingAI ? null : _processWithAI,\n                          icon: _isProcessingAI \n                              ? const SizedBox(\n                                  width: 16,\n                                  height: 16,\n                                  child: CircularProgressIndicator(\n                                    strokeWidth: 2,\n                                    valueColor: AlwaysStoppedAnimation<Color>(Colors.white),\n                                  ),\n                                )\n                              : const Icon(Icons.auto_fix_high, color: Colors.white),\n                          label: Text(\n                            _isProcessingAI ? 'Processing...' : 'Extract Details with AI',\n                            style: const TextStyle(color: Colors.white),\n                          ),\n                          style: ElevatedButton.styleFrom(\n                            backgroundColor: Colors.deepPurple,\n                          ),\n                        ),\n                      ),\n                      const SizedBox(height: 16),\n\n                      const Divider(),\n                      const SizedBox(height: 16),\n                      \n                      // Manual form fields (will be populated by AI)\n                      Row(\n                        mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n                        children: [\n                          ChoiceChip(\n                            label: const Text('Lost'),\n                            selected: _status == 'Lost',\n                            onSelected: (selected) {\n                              if (selected) {\n                                setState(() {\n                                  _status = 'Lost';\n                                });\n                              }\n                            },\n                          ),\n                          ChoiceChip(\n                            label: const Text('Found'),\n                            selected: _status == 'Found',\n                            onSelected: (selected) {\n                              if (selected) {\n                                setState(() {\n                                  _status = 'Found';\n                                });\n                              }\n                            },\n                          ),\n                        ],\n                      ),\n                      const SizedBox(height: 16),\n\n                      // Title dropdown\n                      DropdownButtonFormField<String>(\n                        decoration: const InputDecoration(\n                          labelText: 'Item Title',\n                          border: OutlineInputBorder(),\n                        ),\n                        value: _title,\n                        items: itemsList\n                            .map((itemTitle) => DropdownMenuItem<String>(\n                                  value: itemTitle,\n                                  child: Text(itemTitle),\n                                ))\n                            .toList(),\n                        validator: (value) =>\n                            value == null ? 'Please select a title' : null,\n                        onChanged: (value) {\n                          setState(() {\n                            _title = value;\n                          });\n                        },\n                      ),\n                      const SizedBox(height: 16),\n\n                      // Location dropdown\n                      DropdownButtonFormField<String>(\n                        decoration: const InputDecoration(\n                          labelText: 'Location',\n                          border: OutlineInputBorder(),\n                        ),\n                        value: _location,\n                        items: locationsList\n                            .map((location) => DropdownMenuItem<String>(\n                                  value: location,\n                                  child: Text(location),\n                                ))\n                            .toList(),\n                        onChanged: (value) {\n                          setState(() {\n                            _location = value;\n                            _hostel = null; // Reset hostel selection when location changes\n                          });\n                        },\n                        validator: (value) =>\n                            value == null ? 'Please select a location' : null,\n                      ),\n                      const SizedBox(height: 16),\n\n                      // Hostel dropdown (conditional)\n                      if (_location == 'Boys Hostel' || _location == 'Girls Hostel')\n                        DropdownButtonFormField<String>(\n                          decoration: const InputDecoration(\n                            labelText: 'Hostel Name',\n                            border: OutlineInputBorder(),\n                          ),\n                          value: _hostel,\n                          items: (_location == 'Boys Hostel'\n                                  ? boyshostelsList\n                                  : girlshostelsList)\n                              .map((hostel) => DropdownMenuItem<String>(\n                                    value: hostel,\n                                    child: Text(hostel),\n                                  ))\n                              .toList(),\n                          onChanged: (value) {\n                            setState(() {\n                              _hostel = value;\n                            });\n                          },\n                          validator: (value) {\n                            if ((_location == 'Boys Hostel' ||\n                                    _location == 'Girls Hostel') &&\n                                value == null) {\n                              return 'Please select a hostel';\n                            }\n                            return null;\n                          },\n                        ),\n                      const SizedBox(height: 16),\n\n                      // Description field (can be edited after AI processing)\n                      TextFormField(\n                        decoration: const InputDecoration(\n                          labelText: 'Detailed Description',\n                          border: OutlineInputBorder(),\n                        ),\n                        maxLines: 4,\n                        initialValue: _description,\n                        onSaved: (value) => _description = value,\n                        validator: (value) => value!.isEmpty\n                            ? 'Please enter a description'\n                            : null,\n                      ),\n                      const SizedBox(height: 16),\n\n                      // Question field (only for 'Found' items)\n                      if (_status == 'Found')\n                        TextFormField(\n                          decoration: const InputDecoration(\n                            labelText: 'Verification Question (to ask the Claimer)',\n                            border: OutlineInputBorder(),\n                          ),\n                          onSaved: (value) => _question = value,\n                          validator: (value) {\n                            if (_status == 'Found' &&\n                                (value == null || value.isEmpty)) {\n                              return 'Please provide a verification question for found items';\n                            }\n                            return null;\n                          },\n                        ),\n                      const SizedBox(height: 16),\n\n                      // Image selection\n                      SizedBox(\n                        width: 200,\n                        child: Center(\n                          child: ElevatedButton.icon(\n                            onPressed: _pickImages,\n                            icon: const Icon(Icons.photo_library, color: Colors.white),\n                            label: const Text(\n                              'Select Images',\n                              style: TextStyle(color: Colors.white),\n                            ),\n                            style: ElevatedButton.styleFrom(\n                              backgroundColor: Colors.deepOrange,\n                            ),\n                          ),\n                        ),\n                      ),\n                      const SizedBox(height: 16),\n\n                      // Preview selected images\n                      if (_imageBytes != null && _imageBytes!.isNotEmpty)\n                        SizedBox(\n                          height: 110,\n                          child: ListView.builder(\n                            scrollDirection: Axis.horizontal,\n                            itemCount: _imageBytes!.length,\n                            itemBuilder: (context, index) {\n                              return Padding(\n                                padding: const EdgeInsets.symmetric(horizontal: 8.0),\n                                child: Stack(\n                                  children: [\n                                    ClipRRect(\n                                      borderRadius: BorderRadius.circular(12),\n                                      child: Image.memory(\n                                        _imageBytes![index],\n                                        width: 90,\n                                        height: 100,\n                                        fit: BoxFit.cover,\n                                      ),\n                                    ),\n                                    Positioned(\n                                      top: 0,\n                                      right: 0,\n                                      child: IconButton(\n                                        icon: const Icon(Icons.cancel, color: Colors.red),\n                                        onPressed: () => _removeImage(index),\n                                      ),\n                                    ),\n                                  ],\n                                ),\n                              );\n                            },\n                          ),\n                        ),\n                      const SizedBox(height: 20),\n\n                      // Submit button\n                      Center(\n                        child: ElevatedButton(\n                          onPressed: _isLoading ? null : _submitData,\n                          style: ElevatedButton.styleFrom(\n                            backgroundColor: Colors.deepOrange,\n                          ),\n                          child: Text(\n                            _isLoading ? 'Uploading...' : 'Submit Post',\n                            style: const TextStyle(\n                                color: Colors.white,\n                                fontWeight: FontWeight.bold),\n                          ),\n                        ),\n                      ),\n                    ],\n                  ),\n                ),\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n}"
        }
    ]
}